\input{preambulo}

\begin{document}

\renewcommand{\titulo}{Projeto 8}
\pagenumbering{arabic}
\makecover
\makelists

\section*{Introdução}
... % TODO


\section*{Resumo}
Nesta experiência iniciaremos o uso de células da biblioteca de células da AMS. Para isso será desenvolvido um circuito \emph{Prescaler} 32/33 e feitas simulações sobre ele.


\section*{Questões}

\textbf{1.} Verifique no arquivo \\
    \begin{verbatim}
        /tools/dkit/ams_3.70_mgc/www/index.html
    \end{verbatim} \\
as informações sobre as células digitais disponíveis no processo AMS $0.35 \mu m$. Entenda os dados fornecidos (\emph{Standar Cell DataSheet} -- C35 -- \emph{Core Cells}). \\


\textbf{2.} *Procure o \emph{layout} da célula \textbf{DL1} e o abra no IcStation. Levante e \textbf{desenhe o circuito esquemático} desta célula (não precisa determinar as dimensões dos transistores). Observe com cuidado o \emph{layout} feito. \\

    O esquemático está representado na \fref{imgQ02esquematico} \\
    
    % \img{Esquemático representativo da cécula \textbf{DL1}}{imgQ02esquematico}{imgQ02esquematico} % TODO criar o esquemático XXX adicionar imagem


\textbf{3.} *Observe que na célula \textbf{DL1} as linhas dos sinais de $V_{DD}$ e $V_{SS}$ correm nas extremidades superior e inferior. Qual é a dimensão vertical destas linhas e qual a distância entre elas. Abra outra célula da biblioteca e verifique as dimensões das linhas de $V_{DD}$ e $V_{SS}$ e a distância entre elas. São iguais em todas as células?  Seria/é interessante que fossem/sejam iguais, por quê?  \\
	Dimensão vertical: $0.75$ \\
	Distância: $11.50$ \\

    Analisando outras células, nota-se que as distâncias e dimensões são sempre as mesmas. Isso é feito para que as células possam ser facilmente alinhadas e utilizadas em blocos. \\ % XXX checar com os brothers


\textbf{4.} *Considere o circuito da \fref{imgQ04exemploEsquematco}. Desenhe seu \textbf{esquemático} utilizando as células \textbf{DF3}, \textbf{NAND22}. Como sinal de entrada deve colocar o \emph{\textbf{clock}} e \textbf{D}; como sinal de saída, \textbf{Q}. Gere o símbolo para a célula e faça todas as verificações necessárias. Certifique-se que não haja erros ou \emph{warnings}. \\

    \img{Exemplo de esquemático.}{imgQ04exemploEsquematco}{imgQ04exemploEsquematco}

    O esquemático está representado na \fref{imgQ04esquematico}, e o símbolo na \fref{imgQ04simbolo}. \\
    
    % \img{Esquemático utilizando \textbf{DF3} e \textbf{NAND22}}{imgQ04esquematico}{imgQ04esquematico} % XXX adicionar imagem
    % \img{Símbolo utilizando \textbf{DF3} e \textbf{NAND22}}{imgQ04simbolo}{imgQ04simbolo} % XXX adicionar imagem


\textbf{5.} *A partir das informações dos blocos que compõe este circuito estime o valor máximo da frequência do \emph{clock} que o circuito pode suportar (considere a entrada $D = "1"$, utilize o pior caso entre subida e descida das portas e considere que os sinais são rápidos). Apresente os cálculos. \\

    Analisando o circuito, pode-se notar que a equação que representa o caminho crítico é a seguinte,
    \begin{equation}
        t_{min} = t_{setup} + t_{nand} + t_{hold}
    \end{equation}
    Por analisar as configurações dos componentes, sabe-se que $t_{setup} = 0 ns$, $t_{hold} = 0,129 ns$ e $t_{nand} = ns$. % TODO checar os dados e a equação
    Assim sendo, $t_{min} = X ns$ o que implica uma frequência máxima de \emph{clock} de $XXX GHz$. \\ % TODO terminar XXX o de relatórios anteriores deu 1,42GHz


\textbf{6.} *O que significam tempos de \emph{holding} e de \emph{set-up} em \emph{flip-flops}. Qual seria o valor máximo do \emph{clock}, do exercício acima, caso o tempo de \emph{set-up} fosse de $0,1 ns$. \\

    \begin{description}
        \item[\emph{holding}] \rightarrow Tempo mínimo para segurar o sinal em uma determinada tensão para que o \emph{flip-flop} possa armazená-lo. % XXX checar
        \item[\emph{set-up}]  \rightarrow Tempo para que o \emph{flip-flop} esteja pronto para propagar o sinal, partindo do princípio que o sinal já está armazenado. % XXX checar
    \end{description}

    Recalculando o tempo máximo de \emph{clock}, considerando tempo de \emph{set-up} de $0,1 ns$, tem-se $t_{min} = X$, e logo o valor máximo do \emph{clock} seria de $x Hz$. \\ % TODO calcular


\textbf{7.} *Gere, a partir do esquemático, um arquivo \textbf{\emph{netlist}} para o ELDO. Simule o circuito com os parâmetros típicos e determine a \textbf{máxima velocidade (\emph{clock})} do circuito. Considere \\
\begin{itemize}
    \item a entrada $D = "1"$;
    \item $V_{DD} = 3 V$;
    \item o sinal de \emph{clock} com (tempo de subida) = (tempo de descida) = $0,1 \cdot Período$.
\end{itemize}
Apresente as linhas de comando e sinais utilizados. \\

    As linhas de comando e os sinais utiliados estão representados no \cref{srcQ07simulacao} \\% TODO adicionar código fonte

\begin{lstlisting}[caption=Comandos e sinais utilizados na simulação, label=srcQ07simulação]
 * TODO
\end{lstlisting}


\textbf{8.} *Gere agora o \textbf{\emph{layout} para o circuito} (use para isso o \emph{designviepoint} não o \emph{schematic}). Neste \emph{layout} deve-se tomar cuidado com: \\
\begin{itemize}
    \item a área total do circuito;
    \item o uso correto dos metais e poli como camadas de conexão;
    \item a posição e o tamanho dos \emph{ports} de entrada e saída;
    \item a largura das linhas de $V_{DD}$ e $V_{SS}$, não inferiores a $1 \mu m$ (use \textbf{\emph{Route -- ARoutre NEt Classe}}).
\end{itemize}
Faça a verificação com o \textbf{DRC} (CALIBRE), passe o \textbf{LVS} e elimine todos os erros. \textbf{Apresente a figura do \emph{layout} no relatório}. \\

% TODO


\textbf{9.} *Faça a extração do circuito via o Calibre com a opção \textbf{C+CC} (deve ser usada uma configuração que garanta que o nome dos nós venha do \emph{schematic}). Simule o circuito com parâmetros típicos e determine sua máxima velocidade. Utilize as mesmas condições do exercício 7. \\

% TODO


\textbf{10.} *Extraia agora com a opção \textbf{R+C+CC}. Simule o circuito com parâmetros típicos e determine sua máxima velocidade. Utilize as mesmas condições do exercício 7. \\

% TODO


\textbf{11.} *Monte uma tabela com os resultados obtidos nos exercícios \textbf{5, 7, 9 e 10}. \textbf{Compare e comente} os resultados. \\

% TODO


\textbf{12.} *Determine a área total do circuito que desenhou. \\

% TODO


\textbf{13.} Considere agora o circuito da \fref{imgQ13prescaler}. \\
    O circuito é um \emph{Prescaler} 32/33, bloco comum na implementação de sintetizadores de freqüência para RF (detalhes sobre o funcionamento de sintetizadores no fim da apostila). A parte de cima do circuito, hachurada, é um divisor 4/5 síncrono, cujo o valor de divisão depende do sinal \textbf{\emph{MC}} (\emph{modulus counter}); a parte de baixo é um contador assíncrono modulo 8. O circuito completo divide o sinal de \textbf{\emph{clock}} por 32 quando \textbf{$SM = "0"$} ou por 33 quando \textbf{$SM = "1"$}. \\

    \img{\emph{Prescaler} 32/33}{imgQ13prescaler}{imgQ13prescaler}


\textbf{14.} *A partir dos dados dos blocos que compõe o divisor 4/5 estime o máximo \emph{clock} que o circuito pode suportar (considere que são usados na implementação os blocos \textbf{DF1}, \textbf{NAND23} e \textbf{NOR23} e utilize o pior caso entre subida e descida das portas). Apresente os cálculos. \\

% TODO


\textbf{15.} Desenhe o \textbf{esquemático} do divisor 4/5 utilizando as células \textbf{DF1}, \textbf{NAND23} e \textbf{NOR23}. Como sinal de entrada deve ter o \textbf{\emph{clock}} e \textbf{\emph{MC}}; como sinal de saída o sinal \textbf{\bar{Q}} % XXX Davi!
do \textbf{D-FF mais a esquerda}. Gere o símbolo para a célula e faça a verificação do esquemático e do símbolo. Certifique-se que não haja erros ou mesmo \emph{warnings}. \\


\textbf{16.} *Gere, a partir do esquemático, um arquivo \textbf{\emph{netlist}} para o ELDO. Simule o circuito com parâmetros típicos e determine a máxima velocidade e consumo do circuito (consumo em \textbf{mW/GHz}). Considere \\
\begin{itemize}
    \item $MC = "0"$, para o circuito fazer a divisão por 5;
    \item $V_{DD} = 3 V$;
    \item o sinal de \emph{clock} com (tempo de subida) = (tempo de descida) = 0,1*Periodo.
\end{itemize}
    \textbf{Apresente as linhas de comando e sinais utilizados.} \\

% TODO


\textbf{17.} *Gere agora o \textbf{\emph{layout} do circuito}. Neste \emph{layout} deve tomar cuidado com: \\
\begin{itemize}
    \item a área total do circuito;
    \item o uso correto dos metais e poli como camadas de conexão;
    \item a posição e o tamanho dos \emph{ports} de entrada e saída;
    \item a largura das linhas de $V_{DD}$ e $V_{SS}$, não inferiores a $1 \mu m$.
\end{itemize}
    Faça a verificação com o \textbf{DRC} (CALIBRE), passe o \textbf{LVS} e elimine todos os  erros. \textbf{Apresente a figura do layout no relatório. \\

% TODO


\textbf{18.} *Faça a extração do circuito via o Calibre com a opção \textbf{C+CC}. Simule o circuito com parâmetros típicos e determine a máxima velocidade e consumo do circuito. Considere as mesmas condições do exercício 16. \\

% TODO


\textbf{19.} *Extraia agora com a opção \textbf{R+C+CC}. Simule o circuito com parâmetros típicos e determine a máxima velocidade e consumo do circuito. Considere as mesmas condições do exercício 16. \\

% TODO


\textbf{20.} *\textbf{Monte uma tabela} com os resultados obtidos nos exercícios \textbf{14, 16, 18 e 19}. \textbf{Compare e comente} os resultados. \\

% TODO


\textbf{21.} *Determine a área total do circuito que desenhou. \\

    \img{\emph{Layout} do circuito \emph{Prescaler} 32/33 na tecnologia AMS 0.35 (dimensões de $82 \mu m$ x $35 \mu m$). O divisor 4/5 está indicado com um quadrado tracejado.}{imgQ21layoutPrescaler}{imgQ21layoutPrescaler}

    Observação: A \fref{imgQ21layoutPrescaler} apresenta o \emph{layout} de um \emph{Prescaler} 32/33 completo. Por resultados de simulação, este circuito funciona a 2,4 GHz com consumo de $2,43 mW$ (parâmetros típicos, $V_{DD} = 3 V$). O circuito implementado, por sua vez, funcionou a $1,7 GHz$ com consumo de $2,31 mW$. Tanto a velocidade máxima como grande parte do consumo se deve ao divisor 4/5. Assim podemos, a grosso modo, dizer que o consumo e a velocidade deste divisor é igual a do \emph{Prescaler}. 

% TODO


% TODO adicionar a nota de rodapé, o Sintetizador de Frequências


\end{document}
